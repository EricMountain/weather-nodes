## Project Overview

This is an ESP32-based weather station system with:
- ESP32 firmware (C++) using PlatformIO and Arduino framework
- Python AWS Lambda functions for data processing
- Terraform for infrastructure management

## Building and Testing

### ESP32 Firmware

**Build:**
```bash
# Install PlatformIO
pip install platformio

# Build for specific environment
pio run -e indoor_display_node
pio run -e outdoor_node
pio run -e prototype_node
```

**Test:**
```bash
# Run all unit tests (runs on native platform, no hardware needed)
pio test -e native

# Run specific test
pio test -e native -f test_datetime

# List available tests
pio test --list-tests -e native
```

### Before Building

1. Edit `src/secrets.h` using `src/secrets.h.example` as a template
2. Run `certs/certs-for-urls.sh` to generate certificates

## Code Style and Formatting

* Use clang-format for C++ code (configuration in `.clang-format`)
* Follow Google C++ style guide with 2-space indentation
* **Important:** Do not reorder includes - Arduino macros require specific include order (see `.clang-format`)
* Use existing code style as a reference

## Testing Requirements

* Always write unit tests for new ESP32 code functionality
* Tests run on the native platform without requiring hardware
* Place tests in the `test/` directory
* Tests must pass in CI before merging
* Use mocks in `test/mocks/` for Arduino-specific functionality

## Dependencies

* ESP32 firmware dependencies are managed in `platformio.ini`
* Python dependencies are listed in `requirements.txt`
* Always check for security vulnerabilities before adding new dependencies

## Project-Specific Conventions

* There are four firmware build configurations:
    * `indoor_display_node`: ESP32 with e-paper display
    * `outdoor_node`: ESP32 with outdoor sensors
    * `prototype_node`: ESP32 to experiment with
    * `dummy_node`: ESP32 with no-op functionality. Used to load an ESP32 with minimal code that wonâ€™t upload data.
* Each has specific build flags defined in `platformio.ini`
* Serial monitor speed is 115200 baud
* The project uses custom partition table `min_spiffs.csv`
* Version header is auto-generated by `generate_version_header.py`

## AWS Lambda Functions

* Lambda functions are in `aws/lambdas/`
* Written in Python
* Use shared code from `aws/lambdas/shared/`
* Infrastructure managed with Terraform

## Documentation

* Never generate documentation unless explicitly told to do so.
